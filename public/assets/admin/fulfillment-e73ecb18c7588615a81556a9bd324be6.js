jQuery(document).ready(function(e){e("#create-shipment-button").click(function(){var t=e(this).data("url");return jQuery.ajax({type:"PUT",url:t,dataType:"script"}),!1})});var Hadean=window.Hadean||{};Hadean.Fulfillment={captureInvoiceButton:"#capture-invoice-button-",capturePartInvoiceButton:"#capture-partial-invoice-button-",cancelInvoiceButton:"#cancel-invoice-button-",orderId:null,initialize:function(e,t){var n=jQuery(Hadean.Fulfillment.captureInvoiceButton+e),i=jQuery(Hadean.Fulfillment.capturePartInvoiceButton+e),a=jQuery(Hadean.Fulfillment.cancelInvoiceButton+e);Hadean.Fulfillment.orderId=t,jQuery("#dialog").dialog({bgiframe:!0,autoOpen:!1,height:190,width:460,modal:!0}),n.bind("click",function(){Hadean.Fulfillment.captureInvoice(e)}),i.bind("click",function(){}),a.bind("click",function(){Hadean.Fulfillment.cancelInvoice(e)})},captureInvoice:function(e){return jQuery("#dialog").dialog("option","buttons",[{text:"OK",click:function(){jQuery.ajax({type:"PUT",url:"/admin/fulfillment/orders/"+Hadean.Fulfillment.orderId,data:{invoice_id:e,amount:"all"},complete:function(e){jQuery("#dialog-message").html(200==e.status?e.responseText:e.responseText)},dataType:"html"})}},{text:"Close",click:function(){$(this).dialog("close")}}]),jQuery("#dialog-message").html("Are you sure you want to COLLECT FUNDS for this order?"),jQuery("#dialog-message").css("background-color","#CFD"),jQuery("#dialog").dialog("open"),!1},cancelInvoice:function(e){return jQuery("#dialog").dialog("option","buttons",[{text:"OK",click:function(){jQuery.ajax({type:"DELETE",url:"/admin/fulfillment/orders/"+Hadean.Fulfillment.orderId,data:{invoice_id:e},complete:function(t){200==t.status?(jQuery("#invoice-line-"+e).html(t.responseText),jQuery("#dialog").dialog("close")):jQuery("#dialog-message").html("Sorry there was an error.")},dataType:"html"})}},{text:"Close",click:function(){$(this).dialog("close")}}]),jQuery("#dialog-message").html("Are you sure you want to CANCEL the Order and Shipment?"),jQuery("#dialog-message").css("background-color","#FCD"),jQuery("#dialog").dialog("open"),!1}},jQuery(function(){jQuery.each(jQuery(".order-invoice"),function(e,t){Hadean.Fulfillment.initialize(jQuery(t).data("invoice_id"),jQuery(t).data("order_id"))})});